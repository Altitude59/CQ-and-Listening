<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WA7SJI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Keep it mysterious -->
  <meta name="robots" content="noindex, nofollow" />

  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      color: #fff;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }

    .container {
      height: 100%;
      display: grid;
      place-items: center;
      text-align: center;
      padding: 24px;
    }

    .phrase {
      font-size: clamp(1.6rem, 4vw, 2.4rem);
      letter-spacing: 0.04em;
      margin-bottom: 0.9rem;
    }

    .line2 {
      font-size: clamp(1.0rem, 2.2vw, 1.25rem);
      opacity: 0.78;
      min-height: 1.6em;
    }

    .hint {
      margin-top: 1.2rem;
      font-size: 0.95rem;
      opacity: 0.55;
      max-width: 48rem;
      line-height: 1.55;
      white-space: pre-line;
    }

    .dot {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 10px;
      transform: translateY(1px);
      background: #444;
    }

    .dot.listening { background: #00ff66; }
    .dot.offline   { background: #444; }

    /* Rolling ellipsis (tucked close to the final character) */
    .ellipsis {
      display: none;
      margin-left: 0.05em; /* closer to the 'g' in listening */
    }

    .ellipsis.on {
      display: inline-block;
    }

    .ellipsis span {
      opacity: 0;
      animation: dotAnim 1.4s infinite;
    }

    .ellipsis span:nth-child(1) { animation-delay: 0s; }
    .ellipsis span:nth-child(2) { animation-delay: 0.2s; }
    .ellipsis span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes dotAnim {
      0%   { opacity: 0; }
      20%  { opacity: 1; }
      100% { opacity: 0; }
    }
  </style>
</head>

<body>
  <div class="container">
    <div>
      <div class="phrase">
        <span id="phraseText">Standing by.</span>
        <span class="ellipsis" id="ellipsis">
          <span>.</span><span>.</span><span>.</span>
        </span>
      </div>

      <div class="line2">
        <span class="dot offline" id="dot"></span>
        <span id="statusText">Stay tuned for contact opportunities.</span>
      </div>

      <div class="hint" id="hint">
        If you find us on frequency and make contact with a member, you may receive an invitation to F.E.A.R., the non-club club. Bookmark this site and check back often.
      </div>
    </div>
  </div>

  <script>
    async function loadStatus() {
      const phraseTextEl = document.getElementById("phraseText");
      const ellipsisEl   = document.getElementById("ellipsis");
      const statusTextEl = document.getElementById("statusText");
      const hintEl       = document.getElementById("hint");
      const dotEl        = document.getElementById("dot");

      // Copy blocks
      const OFFLINE = {
        heading: "Standing by.",
        subhead: "Stay tuned for contact opportunities.",
        hint:
          "If you find us on frequency and make contact with a member, you may receive an invitation to F.E.A.R., the non-club club. Bookmark this site and check back often."
      };

      const LISTENING = {
        heading: "CQ and listening",
        hint:
          "One or more members are currently active on the above frequency. If you don't hear any traffic or a dialog between two stations, feel free to reach out by calling WA7SJI, then your call sign. If we hear you, someone will answer you. This is the first of two steps. As a second step, you may receive an invitation to join F.E.A.R, the non-club club."
      };

      try {
        const res = await fetch(`status.json?cb=${Date.now()}`, { cache: "no-store" });
        if (!res.ok) throw new Error("status.json not reachable");

        const data = await res.json();
        const status = String(data.status || "").trim().toLowerCase();

        if (status === "listening") {
          phraseTextEl.textContent = LISTENING.heading;
          ellipsisEl.className = "ellipsis on";
          dotEl.className = "dot listening";

          const mode = data.mode ? ` Â· ${data.mode}` : "";
          statusTextEl.textContent = `${data.frequency || ""}${mode}`.trim();

          hintEl.textContent = LISTENING.hint;
        } else {
          phraseTextEl.textContent = OFFLINE.heading;
          ellipsisEl.className = "ellipsis";
          dotEl.className = "dot offline";

          statusTextEl.textContent = OFFLINE.subhead;
          hintEl.textContent = OFFLINE.hint;
        }
      } catch (e) {
        // Fail quietly into offline copy
        phraseTextEl.textContent = OFFLINE.heading;
        ellipsisEl.className = "ellipsis";
        dotEl.className = "dot offline";

        statusTextEl.textContent = OFFLINE.subhead;
        hintEl.textContent = OFFLINE.hint;

        console.error(e);
      }
    }

    loadStatus();
    setInterval(loadStatus, 15000);
  </script>
</body>
</html>
